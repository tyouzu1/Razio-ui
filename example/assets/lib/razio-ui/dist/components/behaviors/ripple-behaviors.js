"use strict";function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach(function(t){_defineProperty(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=new Array(e);r<e;r++)a[r]=t[r];return a}function _iterableToArrayLimit(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var r=[],a=!0,o=!1,i=void 0;try{for(var n,l=t[Symbol.iterator]();!(a=(n=l.next()).done)&&(r.push(n.value),!e||r.length!==e);a=!0);}catch(t){o=!0,i=t}finally{try{a||null==l.return||l.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles(t){if(Array.isArray(t))return t}module.exports=Behavior({properties:{ripple:{type:Boolean,value:!0}},data:{rippleData:{list:[],selector:".ripple",count:0,timer:null,longPress:!1}},methods:{$createSelectorQuery:function(r){var a=this;return new Promise(function(e,t){a.createSelectorQuery().select(r).fields({size:!0,rect:!0,computedStyle:["backgroundColor"]}).selectViewport().scrollOffset().exec(function(t){e(t)})})},$handleAddRipple:function(j,w){var S=this;this.$createSelectorQuery(this.data.rippleData.selector).then(function(t){var e=t[0],r=e.width,a=(e.height,e.left),o=e.top,i=e.backgroundColor,n=void 0===i?"rgba(255,255,255,1)":i,l=t[1],p=l.scrollLeft,s=l.scrollTop,c=j.detail,u=c.x,y=c.y,d=~~r,f=~~r,b=_slicedToArray(n.match(/(\b[0-9]{1,3}\b)/g),4),h=b[0],m=b[1],D=b[2],g=b[3],A=void 0===g?1:g,_=f<d?d:f,v=_/2,O=u-(a+p)-v,T=y-(o+s)-v;S.setData({"rippleData.longPress":w||!1,"rippleData.list":[].concat(_toConsumableArray(S.data.rippleData.list),[{width:_,height:_,left:O,top:T,backgroundColor:S.$isLight(h,m,D,A)?"rgb(0,0,0)":"rgb(255,255,255)",start:!0,hold:w||!1}])})})},$handleRippleAnimationEnd:function(){var t=this;this.setData({"rippleData.count":this.data.rippleData.count+=1}),this.data.rippleData.timer&&clearTimeout(this.data.rippleData.timer);var e=setTimeout(function(){t.data.rippleData.longPress||(clearTimeout(t.data.rippleData.timer),t.setData({"rippleData.timer":null,"rippleData.count":0,"rippleData.list":t.data.rippleData.list.slice(t.data.rippleData.count)}))},300);this.setData({"rippleData.timer":e})},$ripplelongPress:function(t){this.$handleAddRipple(t,!0)},$handleRippleTouchEnd:function(){var t=this,e=this.data.rippleData.list,r=e[e.length-1];r&&r.hold&&(this.setData({"rippleData.list":[_objectSpread({},r,{start:!1})]}),setTimeout(function(){clearTimeout(t.data.rippleData.timer),t.setData({"rippleData.longPress":!1,"rippleData.list":[],"rippleData.timer":null,"rippleData.count":0})},300))},$isLight:function(t,e,r,a){return.299*parseInt(t)+.578*parseInt(e)+.114*parseInt(r)>=192*a}}});